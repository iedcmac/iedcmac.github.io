<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <META HTTP-EQUIV="Refresh" CONTENT=1800>
    <title>MAC Weather Station</title>
    <link rel="icon" href="images/logo.png"> <!-- should add favicon  -->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/custom.css">
    <!-- update the version number as needed -->
    <!-- <script defer src="/__/firebase/8.4.2/firebase-app.js"></script> -->
    <!-- include only the Firebase features as you need -->
    <!-- <script defer src="/__/firebase/8.4.2/firebase-database.js"></script> -->
    <!-- initialize the SDK after all desired features are loaded -->
    <!-- <script defer src="/__/firebase/init.js"></script> -->
    <!-- firebase.database().ref('/path/to/ref').on('value', snapshot => { }); -->

    <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-database.js"></script>
    <!-- Awesome icon -->
    <script src="https://kit.fontawesome.com/1f8fcc82f7.js" crossorigin="anonymous"></script>
    <!-- Boostrap File -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">


    <link rel="stylesheet"href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <!------------------------Styling------------------------->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300&display=swap');
        
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Secular+One&display=swap" rel="stylesheet">
</head>



<body> <!-- style="background: url(images/back.jpg); background-position: center;background-repeat: repeat;background-size: 100%;" -->
    <!------------------------Page Layout Content------------------------->
    <header>
        <p>Meteorological-Station<!-- &nbsp;&nbsp;Tutodu Educational Services Pvt Ltd.&nbsp;&nbsp;Mar Augusthinose College, Ramapuram --></p>
        <p style="font-size: 21px;font-weight: 500;">
            Tutodu Educational Services Pvt Ltd. & IEDC MAC Ramapuram
        <p>
    </header>

    <div class="container" style="margin-top: 2%;">
        <div class="row gx-5">
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada" style="text-align: center;">Temperature</h2>
                    <img src="images/hot.gif" class="im"><br><!-- temp.png -->
                    <p id="temp" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Humidity</h2>
                    <img src="images/drop.gif" class="im"><br><!-- hum.png -->
                    <p id="hum" class="id"></p>

                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Pressure</h2>
                    <img src="images/meter.gif" class="im"><br>
                    <p id="pre" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Wind Speed</h2>
                    <img src="images/wind.gif" class="im"><br>
                    <p id="wind" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Altitude</h2>
                    <img src="images/goal.gif" class="im"><br><!-- alti.png -->
                    <p id="alti" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">UV</h2>
                    <img src="images/sunny.gif" class="im"><br><!-- uv.png -->
                    <p id="uvindex" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Light</h2>
                    <img src="images/sun.gif" class="im"><br><!-- light.png -->
                    <p id="light" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Wind Direction</h2>
                    <img src="images/windy.gif" class="im"><br><!-- winddir1.png -->
                    <!-- <p id="deg" class="id"></p> -->
                    <p id="dir" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Cloud</h2>
                    <img src="images/clouds.gif" class="im"><br><!-- clouds1.png -->
                    <p id="clo" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Weather</h2>
                    <img src="images/global-warming.gif" class="im"><br>
                    <p id="rain" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Sunrise</h2>
                    <img src="images/sunrise.gif" class="im"><br>
                    <p id="rise" class="id"></p>
                </div>
            </div>
            <div class="col-md-4 outer">
                <div class="sha">
                    <h2 class="animate__animated animate__tada">Sunset</h2>
                    <img src="images/sunset.gif" class="im"><br>
                    <p id="set" class="id"></p>
                </div>
            </div>
        </div> 
    </div>

    <footer>
        <p><!-- 2022&copy; Mar Augusthinose College Weather Station-->2022&copy; Tutodu Educational Services Pvt Ltd.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Developed By Christo Joseph and Toney Abraham (R&D Team Tutodu)</p>
    </footer>

    <!------------------------Scripting------------------------->
    <!-- <script src="js/main.js"></script> -->
    <!------------------------Scripting------------------------->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <script>
        fetch("https://api.openweathermap.org/data/2.5/weather?q=manathoor&appid=68b92a51844b7e1772e93b7151422f04")
        .then(function (response) {
            return response.json();
        })
        .then(function (data) {
            appendData(data);
        })
        .catch(function (err) {
            console.log('error: ' + err);
        });
        // function convertion(val) {
        //     return (val - 273.15).toFixed(2);
        // }
        function direction(deg){
            let direction;
            if ((deg >0)&&(deg<22.5))
                direction = "N";
            else if ((deg>22.5) &&(deg<67.50))
                direction = "NE";
            else if ((deg>67.50) &&(deg<112.5))
                direction = "E";
            else if ((deg>112.5)&&(deg<157.5))
                direction = "SE";
            else if ((deg>157.5)&&(deg<202.5))
                direction = "S";
            else if ((deg>202.5)&&(deg<247.5))
                direction = "SW";
            else if ((deg>247.5)&&(deg<292.5))
                direction = "W";
            else if ((deg>292.5)&&(deg<337.5))
                direction = "NW";
            else 
                direction = "N";
            document.getElementById("dir").innerHTML = direction;
        }
        function appendData(data) {
            
            var r = data["weather"];
            var r1 = JSON.stringify(r);
            var r2 = r1.split(',');
            var r3 = r2[1].split(':');
            let rain = document.getElementById("rain");
            var r4 = r3[1].replace(/[&\/\\#,+()$~%.'":*?<>{}]/g, '');
            rain.innerHTML = r4;

            var win = data["wind"]["speed"];
            let wind = document.getElementById("wind");
            wind.innerHTML =win+"&nbsp;m/s";

            var c = data["clouds"]["all"];
            let clo = document.getElementById("clo");
            clo.innerHTML = c+"&nbsp;%";

            var d = document.getElementById("deg");

            var deg = data["wind"]["deg"];
            var div = document.createElement("div");
            div.innerHTML = `<span>${direction(deg)}</span>`;
            d.appendChild(div);

            var sr = data["sys"]["sunrise"];
            let rise = document.getElementById("rise");
            rise.innerHTML = sr;

            var ss = data["sys"]["sunset"];
            let set = document.getElementById("set");
            set.innerHTML = ss;


            // var r = data["weather"]["id"];
            // let rain = document.getElementById("rain");
            // rain.innerHTML = r;

            
        }
    </script>
    <!-- Configuration of firebase -->
    <script>
    // Your web app's Firebase configuration
    var firebaseConfig={
     apiKey: "AIzaSyBwbDEgSwynRtNoqVAuDQw6erp_OZUhBS0",
     authDomain: "dynamic-f7f88.firebaseapp.com",
     databaseURL: "https://dynamic-f7f88-default-rtdb.firebaseio.com",
     projectId: "dynamic-f7f88",
     storageBucket: "dynamic-f7f88.appspot.com",
     messagingSenderId: "128684880381",
     appId: "1:128684880381:web:af38f4cca4fdaa58c46994",
     measurementId: "G-RS11P9V072"
 };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    var firebaseRef = firebase.database().ref("devices");
    firebaseRef.once("value",function(snapshot){
      var data = snapshot.val();
      for(let i in data){
        console.log(data[i]);
        // document.write(data[i]);
        // document.getElementById("temp").innerHTML=(data[i]);
      }
      var t = data["temp"];
      let temp = document.getElementById("temp");
      temp.innerHTML = t+"&nbsp;&#8451";

      var h = data["hum"];
      let hum = document.getElementById("hum");
      hum.innerHTML = h+"&nbsp;g.&#13221;";

      var p = data["pressure"];
      let pre = document.getElementById("pre");
      pre.innerHTML = p+"&nbsp;hPa";

      var a = data["altitude"];
      let alti = document.getElementById("alti");
      alti.innerHTML = a+"&nbsp;meter";

      var l = data["lightindex"];
      let light = document.getElementById("light");
      light.innerHTML = l+"&nbsp;lm/&#13217;";

      var u =data["uvindex"];
      let uv =document.getElementById("uvindex");
      uvindex.innerHTML = u+"&nbsp;mW/&#13216;";
    })
</script>
</body>
</html>